#!/bin/bash

Lang_Name="KernUP.lang";
AppName="kernup";
Core_Url="https://raw.githubusercontent.com/DamiaX/KernUP/master/KernUP";
MD5_Url="https://raw.githubusercontent.com/DamiaX/KernUP/master/kernup.md5";
RunDir=`echo $PWD`;
InstallDir="$HOME/.KernUP";
AppInstall="$HOME/.KernUP/kernup";

CheckInstall()
{
if [ -f $AppInstall ]; then
rm -rf $AppInstall;
rm -rf "$InstallDir/$AppName";
rm -rf "$InstallDir/$Lang_Name";
rm -rf "$InstallDir/kernup.md5";
mv "$RunDir/$AppName-new" "$AppInstall";
bash $AppInstall;
rm -rf $0;
exit;
fi
}

CheckSum()
{
md5sum -c "kernup.md5";

if [ $? == 0 ] ; then
rm -rf "$RunDir/$AppName";
rm -rf "$RunDir/$Lang_Name";
rm -rf "$RunDir/kernup.md5";
CheckInstall;
mv "$RunDir/$AppName-new" "$RunDir/$AppName";
rm -rf $0;
bash "$RunDir/$AppName";
exit;
else
rm -rf "$RunDir/kernup.md5";
rm -rf "$RunDir/$AppName-new";
rm -rf $0;
exit
fi
}

Download()
{
wget $Core_Url -q -O "$RunDir/$AppName-new";
chmod +x "$RunDir/$AppName-new";
wget $MD5_Url -q -O "$RunDir/kernup.md5";
}

rm -rf "$RunDir/kernup.md5";
killall -q $AppName;

Download;
CheckSum;
